document.addEventListener("DOMContentLoaded",(function(){var e=[].slice.call(document.querySelectorAll("img.lazy")),t=[].slice.call(document.querySelectorAll(".lazy-background")),o=[].slice.call(document.querySelectorAll("[data-bg]"));if("IntersectionObserver"in window){let n=new IntersectionObserver((function(e,t){e.forEach((function(e){if(e.isIntersecting){let t=e.target;t.src=t.dataset.src,t.srcset=t.dataset.srcset,t.classList.remove("lazy"),n.unobserve(t)}}))}));e.forEach((function(e){n.observe(e)}));let a=new IntersectionObserver((function(e,t){e.forEach((function(e){e.isIntersecting&&(e.target.classList.add("visible"),a.unobserve(e.target))}))}));t.forEach((function(e){a.observe(e)}));let c=new IntersectionObserver((function(e,t){e.forEach((function(e){if(e.isIntersecting){let t=e.target;t.style.backgroundImage="url("+t.dataset.bg+")",c.unobserve(t)}}))}));o.forEach((function(e){c.observe(e)}))}else e.forEach((function(e){e.src=e.dataset.src,e.srcset=e.dataset.srcset})),t.forEach((function(e){e.classList.add("visible")})),o.forEach((function(e){e.style.backgroundImage="url("+e.dataset.bg+")"}))}));var searchIcon=document.getElementById("search_icon"),searchToggle=document.querySelector(".search_toggle"),listEventsElement=document.querySelector(".container_list_events"),searchNameMob=document.querySelector("#event_name_mob"),searchLocationMob=document.querySelector("#location_mob"),searchName=document.querySelector("#event_name"),searchLocation=document.querySelector("#location"),modalNotFound=document.querySelector(".container_modal_notfound"),closeModalNotfound=document.querySelector(".close_modal_notfound"),modalReport=document.querySelector(".container_modal_report"),closeModalReport=document.querySelector(".close_modal_report"),btnCreateReport=document.querySelector(".btn_report_error");btnCreateReport.addEventListener("click",(function(){modalReport.style.display="block"})),closeModalReport.addEventListener("click",(function(){modalReport.style.display="none",document.location.href="/"}));var emailOrganaizer=document.querySelector("#modal_report_email").value,isOrganaizer=document.querySelector("#modal_is_organizer").checked,textOrganaizer=document.querySelector("#modal_report_description").value;function validationEmail(e){let t=document.querySelector("#error_report_email");return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)?(t.innerHTML="",!0):(t.innerHTML="Введите валидный E-mail!",!1)}function validationInputText(e){let t=document.querySelector("#error_report_description");return""===e?(t.innerHTML='Поле "Сообщение об ошибке" не должно быть пустым!',!1):(t.innerHTML="",!0)}function sentReport(e,t,o){axios.post("https://eventafisha.com/api/v1/error-message",{email:e,comment:o,is_organizer:t}).then((function(e){document.querySelector(".report_success").style.display="block",setTimeout(closeReport,4e3)})).catch((function(e){document.querySelector(".report_error").style.display="block",setTimeout(closeReport,4e3)}))}function closeReport(){modalReport.style.display="none",document.querySelector(".report_success").style.display="none",document.querySelector(".report_error").style.display="none",document.querySelector("#modal_report_email").value="",document.querySelector("#modal_is_organizer").checked=!1,document.querySelector("#modal_report_description").value=""}document.querySelector("#submit_sent_report").addEventListener("click",(function(){emailOrganaizer=document.querySelector("#modal_report_email").value,isOrganaizer=document.querySelector("#modal_is_organizer").checked,textOrganaizer=document.querySelector("#modal_report_description").value;let e=validationEmail(emailOrganaizer),t=validationInputText(textOrganaizer);e&&t&&sentReport(emailOrganaizer,isOrganaizer,textOrganaizer)}));var spinner=document.querySelector(".block_spinner");getCities("location"),getCities("location_mob"),getCategories(),closeModalNotfound.addEventListener("click",(function(){modalNotFound.style.display="none",document.location.href="/"})),searchIcon.addEventListener("click",()=>showHideSearch());let btnSearch=document.getElementById("btn_search");btnSearch.addEventListener("click",()=>searchTitleCity("event_name","location"));let btnSearchMob=document.getElementById("btn_search_mob");function showHideSearch(){searchToggle.classList.contains("show_toggle_search")?searchToggle.classList.remove("show_toggle_search"):searchToggle.classList.add("show_toggle_search")}function hideSearch(){searchToggle.classList.remove("show_toggle_search")}function createTagsElement(e){let t="";for(let o=0;o<e.length;o++)t+='<div class="event_tag green_tag_info">'+e[o].title+"</div>";return t}function createEventCard(e){let t=checkCostEvent(e.cost),o='<div class="event_card_date_info">\n\t<div class="event_card_date">\n\t\t<img class="event_card_img" src="https://eventafisha.com/storage/'+e.images+'" alt="title">\n\t\t<div class="event_time">'+new Date(e.start_date).toLocaleDateString()+'</div>\n\t</div>\n\t<div class="event_card_info">\n\t\t<div class="event_title_tag">\n\t\t\t<div class="title_img_mob">\n\t\t\t\t<img class="event_card_img_mob" src="https://eventafisha.com/storage/'+e.images+'" alt="title">\n\t\t\t\t<div class="event_title">'+e.title+'</div>\n\t\t\t</div>\n\t\t\t<div class="event_tag">'+e.category.title+'</div>\n\t\t</div>\n\t\t<div class="event_time_mob">'+new Date(e.start_date).toLocaleDateString()+'</div>\n\t\t<div class="event_location_price">\n\t\t\t<div class="event_location">\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" class="location_icon" viewBox="0 0 24 24"><path fill="#666" d="M12 0c-4.198 0-8 3.403-8 7.602 0 4.198 3.469 9.21 8 16.398 4.531-7.188 8-12.2 8-16.398 0-4.199-3.801-7.602-8-7.602zm0 11c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3z"/></svg>\n\t\t\t\t<div class="location_name">'+e.address+"</div>\n\t\t\t</div>"+t+'</div>\n    <div class="tags_info">'+createTagsElement(e.tags)+'</div>\n\t</div>\n\t</div>\n\t<svg xmlns="http://www.w3.org/2000/svg" class="info_icon" viewBox="0 0 24 24"><path class="info_icon_color" d="M14 18l10-7.088-10-6.912v3.042s-11.618 2.583-14 12.958c5.072-5.431 14-5.218 14-5.218v3.218z"/></svg>',n=document.createElement("a");n.setAttribute("target","_blank"),n.href="/event-page.html?id="+e.id,n.className="event_card",n.innerHTML=o,listEventsElement.append(n)}function checkCostEvent(e){return 0==e?"":'<div class="event_price">\n  <svg xmlns="http://www.w3.org/2000/svg" class="price_icon" viewBox="0 0 24 24"><path fill="#666" d="M22 4h-20c-1.104 0-2 .896-2 2v12c0 1.104.896 2 2 2h20c1.104 0 2-.896 2-2v-12c0-1.104-.896-2-2-2zm0 13.5c0 .276-.224.5-.5.5h-19c-.276 0-.5-.224-.5-.5v-6.5h20v6.5zm0-9.5h-20v-1.5c0-.276.224-.5.5-.5h19c.276 0 .5.224.5.5v1.5zm-9 6h-9v-1h9v1zm-3 2h-6v-1h6v1zm10-2h-3v-1h3v1z"/></svg>\n  <div class="price">'+e+"\n  </div>\n  </div>"}function watchWidthDisplay(e){e.matches&&searchToggle.classList.remove("show_toggle_search")}btnSearchMob.addEventListener("click",()=>searchTitleCity("event_name_mob","location_mob"));var widthMedia=window.matchMedia("(min-width: 768px)");function getCities(e){axios.get("https://eventafisha.com/api/v1/cities").then((function(t){for(let o in t.data)addOptionSelect(t.data[o],e)})).catch((function(e){console.log(e)})).then((function(){}))}function getCategories(){axios.get("https://eventafisha.com/api/v1/categories").then((function(e){for(let t in e.data)addCatToSearch(e.data[t],".container_category"),addCatToSearch(e.data[t],".container_category_mob")})).catch((function(e){console.log(e)})).then((function(){}))}function addOptionSelect(e,t){let o=document.getElementById(t),n=document.createElement("option");n.value=e.id,n.innerHTML=e.title,o.add(n)}function addCatToSearch(e,t){let o=document.querySelector(t),n=document.createElement("div");n.classList.add("item_category"),n.setAttribute("category_id",e.id),n.innerHTML=e.title,o.appendChild(n),addEventToElement(n,e.id)}function addEventToElement(e,t){e.addEventListener("click",(function(){delActiveColor(),console.log("CAT - ",t),e.classList.add("color_active_cat"),categorySearch=t,document.querySelector(".arrow_down").classList.add("color_active_cat"),paginationAjax("#pagination",nameEventSearch,cityEventSearch,fromDateSearch,toDateSearch,categorySearch)}))}function delActiveColor(){let e=document.querySelectorAll(".color_active_cat");console.log("arr",e),e.forEach((function(e){e.classList.remove("color_active_cat")}))}function removeEventList(){for(var e=document.querySelector(".container_list_events");e.firstChild;)e.removeChild(e.firstChild)}watchWidthDisplay(widthMedia),widthMedia.addListener(watchWidthDisplay),$((function(){$(".datepicker-here").datepicker({onSelect:function(e,t){console.log(e),splitSearchDate(e)},minDate:new Date,range:!0})})),$((function(){paginationAjax("#pagination","","","","","")}));var fromDateSearch="",toDateSearch="",nameEventSearch="",cityEventSearch="",categorySearch="",nameEventSearchMob="",cityEventSearchMob="",categorySearchMob="",arrElCat=[{el:document.querySelector("#search_cat_all"),id:""},{el:document.querySelector("#search_cat_main1"),id:4},{el:document.querySelector("#search_cat_main2"),id:20},{el:document.querySelector("#search_cat_main3"),id:21},{el:document.querySelector("#search_cat_all_mob"),id:""},{el:document.querySelector("#search_cat_main1_mob"),id:4},{el:document.querySelector("#search_cat_main2_mob"),id:20},{el:document.querySelector("#search_cat_main3_mob"),id:21}];function addListenerToArrEl(e){for(let t in e)e[t].el.addEventListener("click",(function(){delActiveColor(),e[t].el.classList.add("color_active_cat"),categorySearch=e[t].id,paginationAjax("#pagination",nameEventSearch,cityEventSearch,fromDateSearch,toDateSearch,categorySearch)}))}function searchTitleCity(e,t){nameEventSearch=document.getElementById(e).value,cityEventSearch=document.getElementById(t).value,paginationAjax("#pagination",nameEventSearch,cityEventSearch,fromDateSearch,toDateSearch,categorySearch)}function splitSearchDate(e){if(e.indexOf(",")>-1){let t=e.split(",");fromDateSearch=t[0],toDateSearch=t[1]}else fromDateSearch=e}function checkSearchParam(e,t,o,n,a){let c="https://eventafisha.com/api/v1/events?paginate=";return""!==e&&(c+="&title="+e),""!==t&&(c+="&city_id="+t),""!==o&&(c+="&date_start="+o),""!==n&&(c+="&date_end="+n),""!==a&&(c+="&category_id="+a),c}function paginationAjax(e,t,o,n,a,c){let r=checkSearchParam(t,o,n,a,c);$(e).pagination({dataSource:r,locator:"data",totalNumberLocator:function(e){return e.total},pageSize:24,showPageNumbers:!0,showPrevious:!0,showNext:!0,showFirstOnEllipsisShow:!0,showLastOnEllipsisShow:!0,className:"paginationjs-theme-blue paginationjs-small",alias:{pageNumber:"page",pageSize:"limit"},ajax:{beforeSend:function(){spinner.classList.remove("hide_spinner")}},callback:function(e,t){spinner.classList.add("hide_spinner"),0===e.length?modalNotFound.style.display="block":(removeEventList(),$.each(e,(function(e,t){createEventCard(t)}))),window.matchMedia("(max-width: 768px)").matches&&hideSearch()}})}addListenerToArrEl(arrElCat);var catWindow=document.querySelector(".dropdown_content"),containerCatWindow=document.querySelector(".container_category"),btnShowCat=document.querySelector(".dropbtn"),catWindowMob=document.querySelector(".dropdown_content_mob"),containerCatWindowMob=document.querySelector(".container_category_mob"),btnShowCatMob=document.querySelector(".dropbtn_mob");btnShowCat.addEventListener("click",(function(){catWindow.classList.toggle("show")})),btnShowCatMob.addEventListener("click",(function(){catWindowMob.classList.toggle("show")})),window.onclick=function(e){if(!e.target.matches(".dropbtn")){var t=document.querySelector(".dropdown_content");t.classList.contains("show")&&t.classList.remove("show")}if(!e.target.matches(".dropbtn_mob")){var o=document.querySelector(".dropdown_content_mob");o.classList.contains("show")&&o.classList.remove("show")}};